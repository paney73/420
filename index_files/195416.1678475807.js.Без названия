/**
 The MIT License

 Copyright (c) 2010 Daniel Park (http://metaweb.com, http://postmessage.freebaseapps.com)

 Permission is hereby granted, free of charge, to any person obtaining a copy
 of this software and associated documentation files (the "Software"), to deal
 in the Software without restriction, including without limitation the rights
 to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 copies of the Software, and to permit persons to whom the Software is
 furnished to do so, subject to the following conditions:

 The above copyright notice and this permission notice shall be included in
 all copies or substantial portions of the Software.

 THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 THE SOFTWARE.
 **/
var NO_JQUERY={}; (function(f,m,r){if(!("console"in f)){var p=f.console={};p.log=p.warn=p.error=p.debug=function(){}}m===NO_JQUERY&&(m={fn:{},extend:function(){for(var a=arguments[0],b=1,c=arguments.length;b<c;b++){var e=arguments[b],h;for(h in e)a[h]=e[h]}return a}});m.fn.pm=function(){console.log("usage: \nto send: $.pm(options)\nto receive: $.pm.bind(type, fn, [origin])");return this};m.pm=f.pm=function(a){c.send(a)};m.pm.bind=f.pm.bind=function(a,b,d,e){c.bind(a,b,d,e)};m.pm.unbind=f.pm.unbind=function(a,b){c.unbind(a, b)};m.pm.origin=f.pm.origin=null;m.pm.poll=f.pm.poll=200;var c={send:function(a){a=m.extend({},c.defaults,a);var b=a.target;if(a.target)if(a.type){var d={data:a.data,type:a.type};a.success&&(d.callback=c._callback(a.success));a.error&&(d.errback=c._callback(a.error));"postMessage"in b&&!a.hash?(c._bind(),b.postMessage(JSON.stringify(d),a.origin||"*")):(c.hash._bind(),c.hash.send(a,d))}else console.warn("postmessage type required");else console.warn("postmessage target window required")},bind:function(a, b,d,e){"postMessage"in f&&!e?c._bind():c.hash._bind();e=c.data("listeners.postmessage");e||(e={},c.data("listeners.postmessage",e));var h=e[a];h||(h=[],e[a]=h);h.push({fn:b,origin:d||m.pm.origin})},unbind:function(a,b){var d=c.data("listeners.postmessage");if(d)if(a)if(b){var e=d[a];if(e){for(var h=[],n=0,k=e.length;n<k;n++){var l=e[n];l.fn!==b&&h.push(l)}d[a]=h}}else delete d[a];else for(n in d)delete d[n]},data:function(a,b){return b===r?c._data[a]:c._data[a]=b},_data:{},_CHARS:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""), _random:function(){for(var a=[],b=0;32>b;b++)a[b]=c._CHARS[0|32*Math.random()];return a.join("")},_callback:function(a){var b=c.data("callbacks.postmessage");b||(b={},c.data("callbacks.postmessage",b));var d=c._random();b[d]=a;return d},_bind:function(){c.data("listening.postmessage")||(f.addEventListener?f.addEventListener("message",c._dispatch,!1):f.attachEvent&&f.attachEvent("onmessage",c._dispatch),c.data("listening.postmessage",1))},_dispatch:function(a){try{var b=JSON.parse(a.data)}catch(d){return}if(b.type){var e=(c.data("callbacks.postmessage")||{})[b.type];if(e)e(b.data);else for(var e=(c.data("listeners.postmessage")||{})[b.type]||[],h=0,n=e.length;h<n;h++){var k=e[h];if(k.origin&&a.origin!==k.origin)console.warn("postmessage message origin mismatch",a.origin,k.origin),b.errback&&c.send({target:a.source,data:{message:"postmessage origin mismatch",origin:[a.origin,k.origin]},type:b.errback});else try{var l=k.fn(b.data);b.callback&&c.send({target:a.source,data:l,type:b.callback})}catch(f){b.errback&& c.send({target:a.source,data:f,type:b.errback})}}}else console.warn("postmessage message type required")},hash:{send:function(a,b){var d=a.target,e=a.url;if(e){var e=c.hash._url(e),h,n=c.hash._url(f.location.href);if(f==d.parent)h="parent";else try{for(var k=0,l=parent.frames.length;k<l;k++)if(parent.frames[k]==f){h=k;break}}catch(t){h=f.name}null==h?console.warn("postmessage windows must be direct parent/child windows and the child must be available through the parent window.frames list"):(h={"x-requested-with":"postmessage", source:{name:h,url:n},postmessage:b},n="#x-postmessage-id="+c._random(),d.location=e+n+encodeURIComponent(JSON.stringify(h)))}else console.warn("postmessage target window url is required")},_regex:/^\#x\-postmessage\-id\=(\w{32})/,_regex_len:50,_bind:function(){c.data("polling.postmessage")||(setInterval(function(){var a=""+f.location.hash,b=c.hash._regex.exec(a);b&&(b=b[1],c.hash._last!==b&&(c.hash._last=b,c.hash._dispatch(a.substring(c.hash._regex_len))))},m.pm.poll||200),c.data("polling.postmessage", 1))},_dispatch:function(a){if(a){try{if(a=JSON.parse(decodeURIComponent(a)),!("postmessage"===a["x-requested-with"]&&a.source&&null!=a.source.name&&a.source.url&&a.postmessage))return}catch(b){return}var d=a.postmessage,e=(c.data("callbacks.postmessage")||{})[d.type];if(e)e(d.data);else for(var e="parent"===a.source.name?f.parent:f.frames[a.source.name],h=(c.data("listeners.postmessage")||{})[d.type]||[],n=0,k=h.length;n<k;n++){var l=h[n];if(l.origin){var t=/https?\:\/\/[^\/]*/.exec(a.source.url)[0]; if(t!==l.origin){console.warn("postmessage message origin mismatch",t,l.origin);d.errback&&c.send({target:e,data:{message:"postmessage origin mismatch",origin:[t,l.origin]},type:d.errback,hash:!0,url:a.source.url});continue}}try{var m=l.fn(d.data);d.callback&&c.send({target:e,data:m,type:d.callback,hash:!0,url:a.source.url})}catch(s){d.errback&&c.send({target:e,data:s,type:d.errback,hash:!0,url:a.source.url})}}}},_url:function(a){return(""+a).replace(/#.*$/,"")}}};m.extend(c,{defaults:{target:null, url:null,type:null,data:null,success:null,error:null,origin:"*",hash:!1}})})(this,"undefined"===typeof jQuery?NO_JQUERY:jQuery);"JSON"in window&&window.JSON||(JSON={}); (function(){function f(a){return 10>a?"0"+a:a}function m(a){c.lastIndex=0;return c.test(a)?'"'+a.replace(c,function(a){var b=d[a];return"string"===typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function r(c,d){var k,l,f,p,s=a,q,g=d[c];g&&"object"===typeof g&&"function"===typeof g.toJSON&&(g=g.toJSON(c));"function"===typeof e&&(g=e.call(d,c,g));switch(typeof g){case "string":return m(g);case "number":return isFinite(g)?String(g):"null";case "boolean":case "null":return String(g); case "object":if(!g)return"null";a+=b;q=[];if("[object Array]"===Object.prototype.toString.apply(g)){p=g.length;for(k=0;k<p;k+=1)q[k]=r(k,g)||"null";f=0===q.length?"[]":a?"[\n"+a+q.join(",\n"+a)+"\n"+s+"]":"["+q.join(",")+"]";a=s;return f}if(e&&"object"===typeof e)for(p=e.length,k=0;k<p;k+=1)l=e[k],"string"===typeof l&&(f=r(l,g))&&q.push(m(l)+(a?": ":":")+f);else for(l in g)Object.hasOwnProperty.call(g,l)&&(f=r(l,g))&&q.push(m(l)+(a?": ":":")+f);f=0===q.length?"{}":a?"{\n"+a+q.join(",\n"+a)+"\n"+ s+"}":"{"+q.join(",")+"}";a=s;return f}}"function"!==typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(a){return this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z"},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(a){return this.valueOf()});var p=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g, c=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,a,b,d={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},e;"function"!==typeof JSON.stringify&&(JSON.stringify=function(c,d,f){var l;b=a="";if("number"===typeof f)for(l=0;l<f;l+=1)b+=" ";else"string"===typeof f&&(b=f);if((e=d)&&"function"!==typeof d&&("object"!==typeof d||"number"!==typeof d.length))throw Error("JSON.stringify");return r("",{"":c})}); "function"!==typeof JSON.parse&&(JSON.parse=function(a,b){function c(a,d){var e,f,g=a[d];if(g&&"object"===typeof g)for(e in g)Object.hasOwnProperty.call(g,e)&&(f=c(g,e),void 0!==f?g[e]=f:delete g[e]);return b.call(a,d,g)}var d;p.lastIndex=0;p.test(a)&&(a=a.replace(p,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(a.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g, "")))return d=eval("("+a+")"),"function"===typeof b?c({"":d},""):d;throw new SyntaxError("JSON.parse");})})();var RC={fields:{},validators:{1:"checkEqually",2:"checkNotEqually",3:"checkContains",4:"checkNotContains",5:"checkBeginWith",6:"checkEndWith",7:"checkIsGreatherThan",8:"checkIsLessThan",9:"checkIsGreatherThanOrEqually",10:"checkIsLessThanOrEqually"},getField:function(a){this.fields[a]||(this.fields[a]=$(a));return this.fields[a]},inArray:function(a,b){for(var c in b)if(a==b[c])return!0;return!1},pregQuote:function(a){return(a+"").replace(/([\\\.\+\*\?\[\^\]\$\(\)\{\}=!<>\|:])/g,"\\$1")},compareStrings:function(a,
        b){if(!a.length||!b.length)return a.length-b.length;var c=/([^\d]+|\d+)/ig,g=a.toString().match(c);c=b.toString().match(c);for(var d=0,h=Math.min(g.length,c.length);d<h;d++){var e=g[d],f=c[d];if(e!==f)return isNaN(+e)||isNaN(+f)?e>f?1:-1:+e-f}return g.length-c.length},checkEqually:function(a,b){return a==b},checkNotEqually:function(a,b){return a!=b},checkContains:function(a,b){return(new RegExp(this.pregQuote(b),"gi")).test(a)},checkNotContains:function(a,b){return!this.checkContains(a,b)},checkBeginWith:function(a,
        b){return(new RegExp("^"+this.pregQuote(b),"gi")).test(a)},checkEndWith:function(a,b){return(new RegExp(this.pregQuote(b)+"$","gi")).test(a)},checkIsGreatherThan:function(a,b){return this.isNumber(a)&&this.isNumber(b)?+a>+b:0<this.compareStrings(a,b)},checkIsLessThan:function(a,b){return this.isNumber(a)&&this.isNumber(b)?+a<+b:0>this.compareStrings(a,b)},isNumber:function(a){return/^[\d\.]+$/.test(a)},checkIsGreatherThanOrEqually:function(a,b){return 0<=this.compareStrings(a,b)},checkIsLessThanOrEqually:function(a,
        b){return 0>=this.compareStrings(a,b)}};var FDCookie={prefix:"FD_",cookies:{},init:function(){for(var e=document.cookie.split("; "),o=e.length,i=0;i<o;i++){var t=e[i].split("=");t[0]&&(this.cookies[t[0]]={value:t[1],options:{}})}},parse:function(e){for(var o=e.split("; "),i=o.length,t=0;t<i;t++){var n=o[t].split("=");0===n[0].indexOf(this.prefix)&&this.set(n[0].replace(this.prefix,""),n[1])}},get:function(e){var o=this;return new Promise((function(i){if(o.cookies[e])i(o.cookies[e].value);else var t=0,n=setInterval((function(){o.cookies[e]&&(i(o.cookies[e].value),clearInterval(n)),t<=25&&i(void 0),t++}),1e3)}))},set:function(e,o,i){this.cookies[e]={value:o,options:i||{}},i&&(setCookie(e,o,i),this.sync())},sync:function(){new URL(document.referrer||window.location.href).host!==window.location.host&&pm({target:window.parent,type:"cookie",data:{cookie:this.cookies,prefix:this.prefix}})},getAll:function(){return this.cookies}};function getCookie(e){var o=document.cookie.match(new RegExp("(?:^|; )"+e.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,"\\$1")+"=([^;]*)"));return o?decodeURIComponent(o[1]):void 0}function setCookie(e,o,i){var t=(i=i||{}).expires;if("number"==typeof t&&t){var n=new Date;n.setTime(n.getTime()+1e3*t),t=i.expires=n}t&&t.toUTCString&&(i.expires=t.toUTCString());var r=e+"="+(o=encodeURIComponent(o));for(var s in i){r+="; "+s;var c=i[s];!0!==c&&(r+="="+c)}document.cookie=r}FDCookie.init();function setAutoFrameHeight(e,t){t.id=e,pm({target:window.parent,type:e,data:t})}function parseGetParams(e){var t,r,i,a,s,n,o={},d=function(e){return decodeURIComponent(e.replace(/\+/g," "))},l=e.substring(1),c=/([^&;=]+)=?([^&;]*)/g;for(s=function(e){return"object"!=typeof e&&(r=e,e={length:0},r&&Array.prototype.push.call(e,r)),e};i=c.exec(l);)t=i[1].indexOf("["),n=d(i[2]),0>t?o[a=d(i[1])]?(o[a]=s(o[a]),Array.prototype.push.call(o[a],n)):o[a]=n:(a=d(i[1].slice(0,t)),t=d(i[1].slice(t+1,i[1].indexOf("]",t))),o[a]=s(o[a]),t?o[a][t]=n:Array.prototype.push.call(o[a],n));return o}function setField(e,t,r){var i;void 0!==r?(i=RC.getField("[data-name="+e+"]:eq("+r+")")).length||(i=RC.getField("[name^="+e+"]:eq("+r+")")):(i=RC.getField("[data-name="+e+"]")).length||(i=RC.getField("[name^="+e+"]")),debug("setField",e,t,i),i.each((function(e){var r=!1,i=$(this);if(i.is(":radio")||i.is(":checkbox")){var a=i.next().text().trim();$.isArray(t)&&-1!=$.inArray(a,t)?(i.prop("checked",!0).parent(".unit").addClass("unit_checked"),r=!0):$.isPlainObject(t)?$.each(t,(function(e,t){if(t==a)return i.prop("checked",!0).parent(".unit").addClass("unit_checked"),r=!0,!1})):a==t&&(i.prop("checked",!0).parent(".unit").addClass("unit_checked"),r=!0)}else if(i.hasClass("autocomplete")){if($.isArray(t)){var s=[];$.each(t,(function(e,t){var r=$("<option></option>");r.val(t),r.text(t),r.prop("selected",!0),s.push(r)})),i.html(s)}else{var n=$("<option></option>");n.val(t),n.text(t),n.prop("selected",!0),i.html(n)}r=!0}else if(i.hasClass("rangeslider__input"))i.val(t),setTimeout((function(){i.parents(".rangeslider").rangeSlider("set",t)}),100),r=!0;else if(i.hasClass("star-rating__value"))setTimeout((function(){i.parents(".star-rating").FDRating("set",t)}),0),r=!0;else if(i.hasClass("messenger"))setTimeout((function(){i.FDMessenger("set",t)}),0),r=!0;else if(i.hasClass("google-map"))setTimeout((function(){i.prev().data("map").setLatLng(t)}),0),r=!0;else if(i.hasClass("googleAddress"))setTimeout((function(){i.data("address").setAddressValue(t)}),0),r=!0;else if(i.is("select")){var o=i.find('option:contains("'+t+'")');o.size()&&(o.prop("selected",!0).siblings().prop("selected",!1),r=!0)}else $.isArray(t)||$.isPlainObject(t)?t[e]&&(i.val(t[e]),r=!0):(i.val(t),r=""!==t&&null!==t);r&&i.parents(".floatLabel").addClass("hasValue")})),i.eq(0).trigger("change")}Object.keys||(Object.keys=function(e){var t=[];for(var r in e)t.push(r);return t});var iframeId,$pageurl=$("#pageurl"),$referrer=$("#referrer"),getParams=parseGetParams(window.location.search);function debug(){1==getParams.debug&&console.log.apply(console,arguments)}if($.each(getParams,(function(e,t){setField(e,t)})),void 0!==getParams.title&&$("h3:eq(0)").text(getParams.title),window.top.location===window.location)$pageurl.val(window.location.href),$referrer.val(document.referrer);else{if(getParams.referrer&&$referrer.val(getParams.referrer),$pageurl.val(document.referrer),/^((?!chrome|android).)*safari/i.test(navigator.userAgent)){var $sid=$("input[name=sid]"),$form=$sid.parents("form"),action=$form.attr("action");$sid.length&&-1==action.indexOf("sid=")&&$form.attr("action",action+(action.indexOf("?")>0?"&sid=":"?sid=")+$sid.val())}pm.bind("setdata",(function(e){if(e.referrer&&$referrer.val(e.referrer),e.url&&$pageurl.val(e.url),e.fields)for(var t in e.fields)setField(t,e.fields[t]);void 0!==e.title&&$("h3:eq(0)").text(e.title)})),pm.bind("register",(function(e){var t=$("body"),r=$("#pr"),i=r.outerWidth(!0);(setAutoFrameHeight(e.id,{height:Math.max(t.outerHeight(!0),r.outerHeight(!0)),width:i,success:t.data("success")}),e.clientId)&&($('<input type="hidden" name="gaClientId"/>').val(e.clientId).insertAfter($referrer),debug("set gaClientId",e.clientId));e.yaClientId&&($('<input type="hidden" name="yaClientId"/>').val(e.yaClientId).insertAfter($referrer),debug("set yaClientId",e.clientId));if($referrer.val(e.referrer),$pageurl.val(e.url),-1!==e.url.indexOf("debug=1")&&(getParams.debug=!0),e.cookie&&FDCookie.parse(e.cookie),window.iframeId=iframeId=e.id,e.fields)for(var a in e.fields)setField(a,e.fields[a]);void 0!==e.title&&$("h3:eq(0)").text(e.title),window.setInterval((function(){setAutoFrameHeight(e.id,{height:Math.max(t.outerHeight(!0),r.outerHeight(!0)),width:r.outerWidth(!0),success:!1})}),100),getParams.popup&&(t.on("click",(function(t){$(t.target).is("body")&&pm({target:window.parent,type:e.id,data:{closePopup:1,id:e.id}})})),e.height&&e.width&&e.width<=i&&e.width<=(e.mobileWidth||414)?r.css("min-height",e.height):r.css("min-height",0))}))}window.submitFormCallbacks||(window.submitFormCallbacks=[]);function addSubmitFormCallback(b,a){a?window.submitFormCallbacks.unshift(b):window.submitFormCallbacks.push(b)}$(function(){RC.getField('.form').on("submit",function(b){for(var a=$(this),d=window.submitFormCallbacks.length,c=0;c<d;c++){var e=window.submitFormCallbacks[c];try{if(!1===e(a,b))return!1}catch(f){console.error(f)}}"_blank"!=a.prop("target")&&a.parents(".mainForm").addClass("processing");debug("submit")})});!function(a,t){var e={};t.app||(t.app={items:{},data:{}});var i=RC.getField(".form");function r(e,i){var r=i.data("name"),p=s(i.attr("name")),u=i.data("id");if(r&&p&&u){var f=function(t){var e={data:[],items:[]};if(t.is(".type-file")){var i=t.find(":file")[0].files,r=i.length;if(r)for(var s=0;s<r;s++)e.data.push(i[s].name.replace(/.+[\\\/]/,""));else e.data.push(n(t.find(".file-name").text()));e.items=e.data}else if(t.hasClass("type-username")){var p=[];t.find("input").each((function(){var t=a(this).val().trim();""!==t&&p.push(n(t))})),e.items=e.data=[p.join(" ")]}else{var u="";t.find("input, select, textarea").each((function(){var i=a(this);if(t.hasClass("type-radio")||t.hasClass("type-checkbox"))i.is(":checked")&&(u=i.val(),e.data.push(n("-1"===u?i.next().next().val().trim():i.next().text().trim())),e.items.push(u));else{if(i.is("select"))return e.data.push(n(i.find(":selected").text())),e.items.push(i.val()),!1;if(i.is("textarea"))""!==(u=n(i.val().trim()))&&e.data.push(u.replace(/[\r\n]/g,"<br>")),e.items=e.data;else if(i.hasClass("calculation")){if(""!==(u=i.val().trim())){e.data.push(u);var r=i.data("suffix");r&&(u=u.replace(r,""));var s=i.data("prefix");s&&(u=u.replace(s,""));var p=i.data("separator");p&&(u=u.replace(p,"")),e.items.push(function(a){a&&(a=(a=(a=a.toString().replace(/,/g,".")).replace(/[^\d\.\-]+/g,"")).replace(/(^\.+|\.+$)/g,""));return a}(u))}}else if(i.hasClass("date")){if(""!==(u=i.val().trim())){e.data.push(u),e.items.push(u);var f=i.data("format2");if("yyyy-mm-dd"!==f){var d=f.indexOf("yyyy"),l=f.indexOf("mm"),c=f.indexOf("dd"),o=f.indexOf("H"),h=u.toString(),m=0,v=0;-1!==o&&((m=h.substr(o,2))<0&&(m=0),(v=h.substr(o+3,2))<0&&(v=0)),u=new Date(h.substr(d,4),h.substr(l,2)-1,h.substr(c,2),m,v,0,0).getTime()}else u=Date.parse(u);e.items.push(u/1e3)}}else if(t.hasClass("type-matrix")){if(i.is(":checked")){u=i.val().trim();var g=i.data("row")+1,x=t.find(".matrix__row:eq("+g+") .matrix__column:eq(0) label").text().trim();u=n(x+": "+u),e.data.push(u),e.items.push(u)}}else""!==(u=i.val().trim())&&(u=t.hasClass("type-signature")?'<img src="'+u+'" alt="">':n(u),e.data.push(u)),e.items=e.data}}))}return e}(e),d=i.data("index");if(void 0!==d){t.app.data[r]||(t.app.data[r]={});var l=t.app.data[r];l[d]=f.data,t.app.data[r]=l,t.app.data[p]=l,t.app.items[u]||(t.app.items[u]={}),(l=t.app.items[u])[d]=f.items,t.app.items[u]=l}else t.app.data[r]=f.data,t.app.data[p]=f.data,t.app.items[u]=f.items}}function n(a){return a.toString().replace(/<[^>]+>/gi,"")}function s(a){return a.replace(/(\[.*?\])/,"")}function p(a,t,i){Object.defineProperty(a,t,{get:function(){return i},set:function(a){var r;i=a,!e[r=t]||e[r].length<1||e[r].forEach((function(a){a()}))}})}function u(a,t,i,r){a.innerHTML=d(t,i,r),function(a,t){e[a]||(e[a]=[]),e[a].push(t)}(i,(function(){a.innerHTML=d(t,i,r)}))}function f(a,t){var e,i=a.children.length;if(i>0)for(e=0;e<i;e++)f(a.children[e],t);else a.attributes.hasOwnProperty("s-text")&&u(a,t,a.attributes["s-text"].value,a.attributes.hasOwnProperty("s-separator")?a.attributes["s-separator"].value:", ")}function d(t,e,i,r){if(!t[e])return"";if("object"==typeof t[e]){var n=[];if(a.each(t[e],(function(a){n.push(d(t[e],a,i,a))})),void 0!==r){var s=n.join("\\r\\n"===i?"<br>":i);return""!==s?+r+1+". "+s:""}return n.join("<br>")}return t[e]}i.find(".shift").each((function(){var t=a(this),e=t.find("input,select,textarea").eq(0);e.length&&r(t,e)})),i.on("reset",(function(){i.find(".shift").each((function(){var e=a(this),i=e.find("input,select,textarea").eq(0);i.length&&function(a,e){var i=e.data("name"),r=s(e.attr("name")),n=e.data("id");i&&r&&n&&(t.app.data[i]=null,t.app.data[r]=null,t.app.items[n]=null)}(0,i)}))})),i.on("change keyup",(function(t){var e=a(t.target);e.attr("name")&&(r(e.parents(".shift:eq(0)"),e),e.trigger("fd.calculate"))})),function(t){for(var e in t)t.hasOwnProperty(e)&&p(t,e,t[e]);a(".shift, .errorSummary li").each((function(){f(this,t)}))}(t.app.data),window.getValueByName=function(a){return t.app.data[a]||[]},window.getValueByItemId=function(a){return t.app.items[a]||[]}}(jQuery,window);var UUID=new function(){var r=r=>0|r*Math.random(),n=n=>{for(var t="",a=0;a<n;++a)t+=r(16).toString(16);return t};this.generate=function(){return n(8)+"-"+n(4)+"-4"+n(3)+"-"+(3&r(16)|8).toString(16)+n(3)+"-"+n(12)}};!function(e){e.FDEvents=function(i,t,n){if(!RC.getField("body").hasClass("preview")&&(this.formId=i,this.isActivePageHandlers=1e3*n>Date.now(),this.$form=e("#form_"+i),this.$form.length)){this.$page=e(".page.current"),this.url=t,this.pages={},this.items={};var s=this;this.createUuid((function(e){s.init(e)}))}},e.FDEvents.prototype={events:{load:"load",form_view:"form_view",page_view:"page_view",fill_field:"fill_field"},init:function(e){this.uuid=e,this.$page.hasClass("page_first")&&this.sendEvent(this.events.load),this.addFormViewHandler(),this.isActivePageHandlers&&(this.addPageHandler(),this.addFormChangeHandler())},addPageHandler:function(){window.changePageStepHandlers||(window.changePageStepHandlers=[]);var e=this;window.changePageStepHandlers.push((function(i,t,n,s){s||e.sendPageViewEvent(t)}))},addFormViewHandler:function(){if("IntersectionObserver"in window){var i=this,t=new IntersectionObserver((function(e){e[0].intersectionRatio>0&&(i.isActivePageHandlers&&i.$page.length?i.sendPageViewEvent(i.$page.data("id"),!0):i.sendEvent(i.events.form_view),t.unobserve(i.$form[0]))}));t.observe(this.$form[0])}else{var n=e(".page.current");this.isActivePageHandlers&&n.length?this.sendPageViewEvent(n.data("id"),!0):this.sendEvent(this.events.form_view)}},addFormChangeHandler:function(){var i=this;this.$form.on("change",(function(t){var n=e(t.target);if(!n.hasClass("calculation")){var s=n.data("id"),a=window.getValueByItemId(s),r=a[0]&&""!==a[0]&&null!==a[0];r&&!i.items[s]&&(i.items[s]=r,i.sendEvent("fill_field",{id:s}))}}))},sendEvent:function(i,t){t||(t={}),t.form_id=this.formId,t.event=i,t.uuid=this.uuid,e.post(this.url,t)},sendPageViewEvent:function(e,i){if(!this.pages[e]){this.pages[e]=!0;var t={id:e};i&&(t.form_view=1),this.sendEvent(this.events.page_view,t)}},isSessionStorageAvailable:function(){var e="FD";try{return sessionStorage.setItem(e,e),sessionStorage.removeItem(e),!0}catch(e){return!1}},createUuid:function(e){var i,t="fd_id";if(this.isSessionStorageAvailable())return(i=sessionStorage.getItem(t))||(i=UUID.generate(),sessionStorage.setItem(t,i)),void e(i);FDCookie.get(t).then((function(i){i||(i=UUID.generate(),FDCookie.set(t,i,{expires:3600})),e(i)}))}}}(jQuery);$(function(){new $.FDEvents(195416, "/form/events", 0); var $pages = RC.getField('.pages'), $page = $pages.find('.page'), prev = $('.prev'), next = $('.next'), $buttons = $('.btn'), $submit = $(':submit', $buttons), $currPageInput = $('#current_page'), currPageIndex = $page.index($pages.find('.current'))+1, totalPages = $page.length; var PagesStorage = { pages: {}, get: function(id) { if (!this.pages[id]) { this.pages[id] = $('#page_' + id); } return this.pages[id]; } }; if (!window.changePageStepHandlers) { window.changePageStepHandlers = []; } if (window.setTooltip) { window.changePageStepHandlers.push(function(currPageIndex, pageId, totalPages) { var $current = PagesStorage.get(pageId); if (!$current.data('tooltip')) { window.setTooltip($current.find('.tooltip')); $current.data('tooltip', true); } }); } $('.text, :radio, :checkbox').on('keypress', function(e) { if (e.which == 13 && currPageIndex < totalPages && !$(this).is('textarea') && next.is(':visible')) { $('.page.current .next').trigger('click'); return false; } }); $('.nav').on('click', function(){ var $current = $pages.find('.current'); var curPageId = $current.data('id'); var prevIds = $pages.data('prev') || []; var nextIds = $pages.data('next') || []; var isPrev = false; if ($(this).val() == 'next') { isPrev = false; prevIds.push(curPageId); $pages.data('prev', prevIds); var nextPageId = nextIds.shift(); $pages.data('next', nextIds); if (nextPageId && nextPageId != curPageId) { $current.removeClass('current'); $current = PagesStorage.get(nextPageId); currPageIndex = $page.index($current)+1; } else { currPageIndex++; $current = $current.removeClass('current').next(); while(!$current.find('.shift:not(.hide,.btn)').length) { if (currPageIndex >= totalPages) { break; } $current = $current.next(); currPageIndex++; } } $current.addClass('current'); if (currPageIndex >= totalPages) { } } else{ isPrev = true; var prevPageId = prevIds.pop(); $pages.data('prev', prevIds); nextIds.unshift($current.data('id')); $pages.data('next', nextIds); if (prevPageId) { $current.removeClass('current'); $current = PagesStorage.get(prevPageId); currPageIndex = $page.index($current)+1; } else { currPageIndex--; $current = $current.removeClass('current').prev(); while(!$current.find('.shift:not(.hide,.btn)').length) { if (currPageIndex <= 1) { break; } $current = $current.prev(); currPageIndex--; } } $current.addClass('current'); } var pageId = $current.data('id'); $currPageInput.val(pageId); executePageStepHandlers(currPageIndex, pageId, totalPages, isPrev); if (iframeId) { pm({ target: window.parent, type: iframeId, data: {scrollTop: -20, id: iframeId} }); } else { $("html, body").animate({scrollTop:0}, 500); } }); function executePageStepHandlers(currPageIndex, pageId, totalPages, isPrev) { var countHandlers = window.changePageStepHandlers.length; var i = 0; for (i; i < countHandlers; i++) { var handler = window.changePageStepHandlers[i]; handler(currPageIndex, pageId, totalPages, isPrev); } } });